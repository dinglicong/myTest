<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	<body>
		<div id="myDiv" style="background-color: lightblue;width: 0;height: 20px;line-height: 20px;">0%</div>
		<button id="btn">run</button>
		<script>
			/*
			 * 大多数电脑显示器的刷新频率是60Hz，大概相当于每秒钟重绘60次。
			 * 大多数浏览器都会对重绘操作加以限制，不超过显示器的重绘频率，
			 * 因为即使超过那个频率用户体验也不会有提升。因此，最平滑动画的最佳循环间隔是1000ms/60，
			 * 约等于16.6ms
			 * 
			 * 而setTimeout和setInterval的问题是，它们都不精确。
			 * 它们的内在运行机制决定了时间间隔参数实际上只是指定了
			 * 把动画代码添加到浏览器UI线程队列中以等待执行的时间。
			 * 如果队列前面已经加入了其他任务，那动画代码就要等前面的任务完成后再执行
			 * 
			 * requestAnimationFrame采用系统时间间隔，保持最佳绘制效率，
			 * 不会因为间隔时间过短，造成过度绘制，增加开销；
			 * 也不会因为间隔时间太长，使用动画卡顿不流畅，
			 * 让各种网页动画效果能够有一个统一的刷新机制，从而节省系统资源，
			 * 提高系统性能，改善视觉效果
			 * 
			 * 
			 * http://www.cnblogs.com/xiaohuochai/p/5777186.html
			 */
			// setInterval
//			var timer;
//			btn.onclick = function(){
//			    clearInterval(timer);
//			    myDiv.style.width = '0';
//			    timer = setInterval(function(){
//			        if(parseInt(myDiv.style.width) < 500){
//			            myDiv.style.width = parseInt(myDiv.style.width) + 5 + 'px';
//			            myDiv.innerHTML =     parseInt(myDiv.style.width)/5 + '%';    
//			        }else{
//			            clearInterval(timer);
//			        }        
//			    },16);
//			}
			// setTimeout
//			var timer;
//			btn.onclick = function(){
//			    clearTimeout(timer);
//			    myDiv.style.width = '0';
//			    timer = setTimeout(function fn(){
//			        if(parseInt(myDiv.style.width) < 500){
//			            myDiv.style.width = parseInt(myDiv.style.width) + 5 + 'px';
//			            myDiv.innerHTML =     parseInt(myDiv.style.width)/5 + '%';
//			            timer = setTimeout(fn,16);
//			        }else{
//			            clearTimeout(timer);
//			        }    
//			    },16);
//			}
//			var timer;
//			btn.onclick = function(){
//			    myDiv.style.width = '0';
//			    cancelAnimationFrame(timer);
//			    timer = requestAnimationFrame(function fn(){
//			        if(parseInt(myDiv.style.width) < 500){
//			            myDiv.style.width = parseInt(myDiv.style.width) + 5 + 'px';
//			            myDiv.innerHTML =     parseInt(myDiv.style.width)/5 + '%';
//			            timer = requestAnimationFrame(fn);
//			        }else{
//			            cancelAnimationFrame(timer);
//			        }    
//			    });
//			}
		</script>
	</body>
</html>
